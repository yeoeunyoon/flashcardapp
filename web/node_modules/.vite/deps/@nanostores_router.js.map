{
  "version": 3,
  "sources": ["../../.pnpm/@nanostores+router@0.16.1_nanostores@0.10.3/node_modules/@nanostores/router/index.js"],
  "sourcesContent": ["import { atom, onMount } from 'nanostores'\n\nexport function createRouter(routes, opts = {}) {\n  let router = atom()\n  router.routes = Object.keys(routes).map(name => {\n    let pattern = routes[name]\n\n    if (typeof pattern !== 'string') {\n      return [name, ...[pattern].flat()]\n    }\n\n    pattern = pattern.replace(/\\/$/g, '') || '/'\n\n    let regexp = pattern\n      .replace(/[\\s!#$()+,.:<=?[\\\\\\]^{|}]/g, '\\\\$&')\n      .replace(/\\/\\\\:(\\w+)\\\\\\?/g, '(?:/(?<$1>(?<=/)[^/]+))?')\n      .replace(/\\/\\\\:(\\w+)/g, '/(?<$1>[^/]+)')\n\n    return [name, RegExp('^' + regexp + '$', 'i'), null, pattern]\n  })\n\n  let prev\n  let parse = href => {\n    let url = new URL(href.replace(/#$/, ''), 'http://a')\n    let cache = url.pathname + url.search + url.hash\n    if (prev === cache) return false\n    prev = cache\n\n    let path = opts.search ? url.pathname + url.search : url.pathname\n    path = path.replace(/\\/($|\\?)/, '$1') || '/'\n\n    for (let [route, regexp, callback] of router.routes) {\n      let match = path.match(regexp)\n      if (match) {\n        return {\n          hash: url.hash,\n          params: callback\n            ? callback(...match.slice(1))\n            : Object.keys({ ...match.groups }).reduce((params, key) => {\n                params[key] = match.groups[key]\n                  ? decodeURIComponent(match.groups[key])\n                  : ''\n                return params\n              }, {}),\n          path,\n          route,\n          search: Object.fromEntries(url.searchParams)\n        }\n      }\n    }\n  }\n\n  let click = event => {\n    let link = event.target.closest('a')\n    if (\n      link &&\n      event.button === 0 && // Left mouse button\n      link.target !== '_blank' && // Not for new tab\n      link.origin === location.origin && // Not external link\n      link.rel !== 'external' && // Not external link\n      link.target !== '_self' && // Now manually disabled\n      !link.download && // Not download link\n      !event.altKey && // Not download link by user\n      !event.metaKey && // Not open in new tab by user\n      !event.ctrlKey && // Not open in new tab by user\n      !event.shiftKey && // Not open in new window by user\n      !event.defaultPrevented // Click was not cancelled\n    ) {\n      event.preventDefault()\n      let hashChanged = location.hash !== link.hash\n      router.open(link.href)\n      if (hashChanged) {\n        location.hash = link.hash\n        if (link.hash === '' || link.hash === '#') {\n          window.dispatchEvent(new HashChangeEvent('hashchange'))\n        }\n      }\n    }\n  }\n\n  let set = router.set\n  if (process.env.NODE_ENV !== 'production') {\n    delete router.set\n  }\n\n  let change = () => {\n    let page = parse(location.href)\n    if (page !== false) set(page)\n  }\n\n  if (typeof window !== 'undefined' && typeof location !== 'undefined') {\n    onMount(router, () => {\n      let page = parse(location.href)\n      if (page !== false) set(page)\n      if (opts.links !== false) document.body.addEventListener('click', click)\n      window.addEventListener('popstate', change)\n      window.addEventListener('hashchange', change)\n      return () => {\n        prev = undefined\n        document.body.removeEventListener('click', click)\n        window.removeEventListener('popstate', change)\n        window.removeEventListener('hashchange', change)\n      }\n    })\n  } else {\n    set(parse('/'))\n  }\n\n  router.open = (path, redirect) => {\n    let page = parse(path)\n    if (page !== false) {\n      if (typeof history !== 'undefined') {\n        if (redirect) {\n          history.replaceState(null, null, path)\n        } else {\n          history.pushState(null, null, path)\n        }\n      }\n      set(page)\n    }\n  }\n\n  return router\n}\n\nexport function getPagePath(router, name, params, search) {\n  if (typeof name === 'object') {\n    search = params\n    params = name.params\n    name = name.route\n  }\n  let route = router.routes.find(i => i[0] === name)\n  if (process.env.NODE_ENV !== 'production') {\n    if (!route[3]) throw new Error('RegExp routes are not supported')\n  }\n  let path = route[3]\n    .replace(/\\/:\\w+\\?/g, i => {\n      let param = params && params[i.slice(2, -1)]\n      if (param) {\n        return '/' + encodeURIComponent(param)\n      } else {\n        return ''\n      }\n    })\n    .replace(/\\/:\\w+/g, i => '/' + encodeURIComponent(params[i.slice(2)]))\n  if (search) {\n    let postfix = '' + new URLSearchParams(search)\n    if (postfix) return path + '?' + postfix\n  }\n  return path\n}\n\nexport function openPage(router, name, params, search) {\n  router.open(getPagePath(router, name, params, search))\n}\n\nexport function redirectPage(router, name, params, search) {\n  router.open(getPagePath(router, name, params, search), true)\n}\n"],
  "mappings": "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",
  "names": []
}
